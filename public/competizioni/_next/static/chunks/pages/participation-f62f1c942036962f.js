(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[989],{6814:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/participation",function(){return n(8001)}])},8001:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var i=n(5893),a=n(7294),s=n(1163),r=n(7288),c=n(5684),o=n(9871);function u(e){var t=function(){R(!0),e.onFormSubmit({name:u,downloadUrl:h,shortDescription:p,description:v,thumbnailFile:I},(function(e){e.success||z(e.error),k(e.success),R(!1)}))},n=e.participation||[],s=n.game_thumbnail?o.Z.getInstance().imageURL+n.game_thumbnail+"?"+Date.now().toString():"",r=(0,a.useState)(n.game_name||""),u=r[0],l=r[1],d=(0,a.useState)(n.game_url||""),h=d[0],g=d[1],m=(0,a.useState)(n.game_short_desc||""),p=m[0],x=m[1],f=(0,a.useState)(n.game_desc||""),v=f[0],j=f[1],b=(0,a.useState)(!1),S=b[0],_=b[1],w=(0,a.useState)(s),C=w[0],N=w[1],y=(0,a.useState)(!0),D=y[0],k=y[1],L=(0,a.useState)(),P=L[0],z=L[1],F=(0,a.useState)(),I=F[0],E=F[1],M=(0,a.useState)(),O=M[0],R=M[1];(0,a.useEffect)((function(){var e=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(h);_(e),e||k(!0)}),[h]);var T="";return C&&(T=(0,i.jsx)("div",{children:(0,i.jsx)("img",{className:"image-centered",alt:u,width:320,height:180,src:C})})),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"h3 me-3",children:"Informazioni Gioco"}),(0,i.jsx)("input",{type:"button",value:"Salva",disabled:D||O,onClick:t})]}),(0,i.jsx)("div",{style:{color:"red"},children:P}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"h6 me-3",children:"Nome"}),(0,i.jsx)("input",{type:"text",maxLength:128,value:u,style:{width:"60%"},onChange:function(e){l(e.target.value),k(!1)}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"h6 me-3",children:"Link Download"}),(0,i.jsx)("input",{type:"text",maxLength:256,value:h,style:{width:"60%"},onChange:function(e){g(e.target.value),k(!1)}}),S?" \u2713":" Link non valido"]}),(0,i.jsxs)("div",{children:[T,(0,i.jsxs)("label",{children:["Upload Image (max ",c.Config.maxThumbnailSize/1024,"KB)"]}),(0,i.jsx)("input",{type:"file",accept:".png,.jpg,.jpeg,.gif",onClick:function(e){N(null),E(null),k(!1),e.target.value=null,z(null)},onChange:function(e){return function(e){if(e.size>c.Config.maxThumbnailSize)return z("L'immagine \xe8 troppo grande ("+Math.ceil(e.size/1024)+"KB)");var t=new FileReader;t.onload=function(e){N(e.target.result)},t.readAsDataURL(e),E(e),z(null),k(!1)}(e.target.files[0])}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"h6",children:"Descrizione Breve (max 256 caratteri)"}),(0,i.jsx)("textarea",{value:p,maxLength:256,onChange:function(e){x(e.target.value),k(!1)}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"h6",children:"Descrizione (max 1024 caratteri)"}),(0,i.jsx)("textarea",{value:v,style:{height:300},maxLength:c.Config.descriptionMaxLength,onChange:function(e){j(e.target.value),k(!1)}})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("input",{style:{float:"right"},type:"button",value:"Salva",disabled:D||O,onClick:t}),(0,i.jsx)("input",{type:"button",value:"Disiscriviti",disabled:O,onClick:function(){confirm("Vuoi disiscriverti e cancellare il gioco?")&&e.onDelete()}})]})]})}function l(e){var t=function(){o.Z.getInstance().getParticipation(g.contest,(function(e){e.success?(_(!!e.participation),x(e.participation)):j(e.error)}))},n=function(e,n){console.log("submit",e),o.Z.getInstance().setParticipationData(g.contest,e,(function(e){e.success&&e.joined&&t(),n(e)}))},l=function(){console.log("delete"),o.Z.getInstance().deleteParticipationData(g.contest,(function(e){e.success?(alert("Cancellato con successo"),h.push("/contest?contest="+g.contest)):j(e.error)}))},d=function(e){return(0,i.jsxs)("div",{className:"shadow border p-3",children:[e,(0,i.jsx)("p",{children:(0,i.jsx)("input",{type:"button",onClick:function(){return h.push("/contest?contest="+g.contest)},value:"Indietro"})})]})},h=(0,s.useRouter)(),g=(0,r.getQuery)(h),m=(0,a.useState)(),p=m[0],x=m[1],f=(0,a.useState)(),v=f[0],j=f[1],b=(0,a.useState)(!1),S=b[0],_=b[1];if((0,a.useEffect)(t,[g.contest]),v)return d(v);if(S){if(p){var w=p.kind==c.ParticipantType.judge;return d((0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:["Sei iscritto come ",w?"Giudice":"Partecipante"]}),(0,i.jsx)(u,{participation:p,onFormSubmit:n,onDelete:l})]}))}return(0,i.jsx)("div",{children:"loading"})}return d((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:"Non sei ancora iscritto a questa competizione"}),(0,i.jsx)(u,{participation:p,onFormSubmit:n,onDelete:l})]}))}var d=n(9008),h=n.n(d);function g(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h(),{children:(0,i.jsx)("title",{children:"Participation"})}),(0,i.jsx)(l,{})]})}},7288:function(e){"use strict";var t=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];e.exports={getQuery:function(e){var t=e.asPath.lastIndexOf("?"),n=e.asPath.substring(t+1);return Object.fromEntries(new URLSearchParams(n))},getItalianDate:function(e){return e.getDate()+" "+t[e.getMonth()]}}}},function(e){e.O(0,[774,888,179],(function(){return t=6814,e(e.s=t);var t}));var t=e.O();_N_E=t}]);